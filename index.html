<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <title>Fasciculus</title>
    <meta name="description" content="">
    <meta name="author" content="Kyler Brown">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="/theme/html5.js"></script>
    <![endif]-->

    <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Fasciculus Atom Feed" />

    <!-- Le styles -->
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.1.1/css/bootstrap.no-icons.min.css" rel="stylesheet">
    <link href="/theme/local.css" rel="stylesheet">
    <link href="/theme/pygments.css" rel="stylesheet">
    <link href="/theme/font-awesome.css" rel="stylesheet">
    <!-- <link href='http://fonts.googleapis.com/css?family=Gudea:400,400italic|Alegreya+SC' rel='stylesheet' type='text/css'> -->

</head>

<body>
<header class="blog-header">
  <div class="container">
    <div class="row-fluid">
      <div class="span9">
	<a href="" class="brand">Fasciculus</a>
      </div>

      <div class="span3" id="blog-nav">
	<ul class="nav nav-pills pull-right">
	    <li >
	      <a href="/category/python.html ">Python</a>
	    <li >
	      <a href="/category/science.html ">Science</a>
	</ul>
      </div>
    </div> <!-- End of fluid row-->
  </div>   <!-- End of Container-->
</header>
    
<div class="container">
    <div class="content">
    <div class="row-fluid">

        <div class="span10">
        

        

    <div class='row-fluid''>
        <div class="article-title span9">
            <a href="/finding-common-mode-rejection-coefficient.html"><h1>Finding the Common Mode Rejection&nbsp;Coefficient</h1></a>
        </div>
    </div>
    <div class="row-fluid">
      <div class="span2">
<p>Fri 25 December 2015 </p>

<p style="text-align: left;">
Filed under <a href="/category/science.html">Science</a>
</p>
<p style="text-align: left;">
 
    Tags <a href="/tag/signal-processing.html">signal processing</a> <a href="/tag/python.html">python</a> <a href="/tag/science.html">science</a> </p>
<p>
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="kye_brown">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
</p>
      </div>
      <div class="article-content span8">
	<p>(an IPython notebook with the same content can be found here: <a class="reference external" href="https://gist.github.com/kylerbrown/a612923f1cd071c9bedd">https://gist.github.com/kylerbrown/a612923f1cd071c9bedd</a>&nbsp;)</p>
<p>Assume you have two channels, <span class="formula"><i>A</i><sub><i>t</i></sub></span> and <span class="formula"><i>B</i><sub><i>t</i></sub></span> where
<span class="formula"><i>t</i> ∈ 0, 1, 2, &#8230;<i>T</i></span>. Each channel is composed of a linear sum
of a unique signal and a common noise, with the noise scaled by an
unknown&nbsp;constant.</p>
<div class="formula">
<span class="environment"><span class="arrayrow">
<span class="arraycell align-r">
<i>A</i><sub><i>t</i></sub>
</span>
<span class="arraycell align-l">
 = <i>a</i><sub><i>t</i></sub> + <i>N</i><sub><i>t</i></sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
<i>B</i><sub><i>t</i></sub>
</span>
<span class="arraycell align-l">
 = <i>b</i><sub><i>t</i></sub> + <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>N</i><sub><i>t</i></sub></span><span class="ignored">)/(</span><span class="denominator"><i>C</i></span><span class="ignored">)</span></span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>

</span>
</span>
</div>
<p>If <span class="formula"><i>C</i></span> was known, we could remove the noise from the difference of
the two channels optimally, that&nbsp;is:</p>
<div class="formula">
<i>A</i><sub><i>t</i></sub> − <i><span class="caps">CB</span></i><sub><i>t</i></sub> = (<i>a</i><sub><i>t</i></sub> + <i>N</i><sub><i>t</i></sub>) − <i>C</i>(<i>b</i><sub><i>t</i></sub> + <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>N</i><sub><i>t</i></sub></span><span class="ignored">)/(</span><span class="denominator"><i>C</i></span><span class="ignored">)</span></span>) = <i>a</i><sub><i>t</i></sub> − <i>C</i><i>b</i><sub><i>t</i></sub>
</div>
<p>In paired, chonically implanted electrodes, common noise and movement
artifacts can be reduced (but in practice not eliminated) using this&nbsp;method.</p>
<div class="section" id="solving-for-c-analytically">
<h2>Solving for <span class="formula"><i>C</i></span>&nbsp;analytically</h2>
<p>We&#8217;d like to minimize the <strong>s</strong>um <strong>s</strong>quared <strong>d</strong>ifference
between <span class="formula"><i>A</i><sub><i>n</i></sub></span> and <span class="formula"><i><span class="caps">CB</span></i><sub><i>N</i></sub></span>.</p>
<div class="formula">
<i><span class="caps">SSD</span></i> = <span class="limits"><span class="limit"><span class="symbol">∑</span></span></span>(<i>A</i><sub><i>t</i></sub> − <i>C</i><i>B</i><sub><i>t</i></sub>)<sup>2</sup>
</div>
<p>Taking the derivative with respect to C and setting the derivative to
zero, we&nbsp;find</p>
<div class="formula">
<span class="environment"><span class="arrayrow">
<span class="arraycell align-r">
<span class="fraction"><span class="ignored">(</span><span class="numerator"><i>dSSD</i></span><span class="ignored">)/(</span><span class="denominator"><i>dC</i></span><span class="ignored">)</span></span>
</span>
<span class="arraycell align-l">
 = 
</span>
<span class="arraycell align-r">
2<span class="limits"><span class="limit"><span class="symbol">∑</span></span></span>(<i>A</i><sub><i>t</i></sub> − <i>C</i><i>B</i><sub><i>t</i></sub>)<i>B</i><sub><i>t</i></sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-r">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
0
</span>
<span class="arraycell align-l">
 = 
</span>
<span class="arraycell align-r">
<span class="limits"><span class="limit"><span class="symbol">∑</span></span></span><i>A</i><sub><i>t</i></sub><i>B</i><sub><i>t</i></sub> − <i>C</i><span class="limits"><span class="limit"><span class="symbol">∑</span></span></span><i>B</i><span class="scripts"><sup class="script">2</sup><sub class="script"><i>t</i></sub></span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-r">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
<i>C</i>
</span>
<span class="arraycell align-l">
 = 
</span>
<span class="arraycell align-r">
<span class="fraction"><span class="ignored">(</span><span class="numerator"><span class="limits"><span class="limit"><span class="symbol">∑</span></span></span><i>A</i><sub><i>t</i></sub><i>B</i><sub><i>t</i></sub></span><span class="ignored">)/(</span><span class="denominator"><span class="limits"><span class="limit"><span class="symbol">∑</span></span></span><i>B</i><span class="scripts"><sup class="script">2</sup><sub class="script"><i>t</i></sub></span></span><span class="ignored">)</span></span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-r">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>

</span>
</span>
</div>
<p>In Python, this would look something&nbsp;like:</p>
<pre class="code python literal-block">
<span class="c"># setting up the problem</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="n">common_noise</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="n">true_C</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="n">signal_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="mi">110</span><span class="p">)</span>
<span class="n">signal_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="mi">300</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">signal_1</span> <span class="o">+</span> <span class="n">common_noise</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">signal_2</span> <span class="o">+</span> <span class="n">common_noise</span> <span class="o">/</span> <span class="n">true_C</span>

<span class="c"># solving for C</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;True C: {}, computed C {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">true_C</span><span class="p">,</span> <span class="n">C</span><span class="p">))</span>
</pre>
<pre class="literal-block">
True C: 0.5, computed C 0.499955696052
</pre>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;A&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;B&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">C</span><span class="o">*</span><span class="n">B</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;A-CB&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
</pre>
<img alt="Noisy B signal" src="/images/common_mode_rejection_files/common_mode_rejection_3_0.png" />
<p>Interestingly, this method works less well with a lower noise channels,
for&nbsp;example:</p>
<pre class="code python literal-block">
<span class="n">common_noise</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">signal_1</span> <span class="o">+</span> <span class="n">common_noise</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">signal_2</span> <span class="o">+</span> <span class="n">common_noise</span> <span class="o">/</span> <span class="n">true_C</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;True C: {}, computed C {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">true_C</span><span class="p">,</span> <span class="n">C</span><span class="p">))</span>
</pre>
<pre class="literal-block">
True C: 0.5, computed C 0.350776916893
</pre>
<pre class="code python literal-block">
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;A&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;B&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">C</span><span class="o">*</span><span class="n">B</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;A-CB&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
</pre>
<img alt="Less noisy B signal" src="/images/common_mode_rejection_files/common_mode_rejection_6_0.png" />
</div>
<div class="section" id="solving-for-c-using-optimization">
<h2>Solving for <span class="formula"><i>C</i></span> using&nbsp;optimization</h2>
<p>We can use optimization packages, such as scipy&#8217;s <tt class="docutils literal">optimize</tt> module to
check our analytical&nbsp;solution.</p>
<pre class="code python literal-block">
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>
<span class="k">def</span> <span class="nf">SSD</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;returns the sum squared of a - c*b&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">SSD</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;True C: {}, computed C: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">true_C</span><span class="p">,</span> <span class="n">C</span><span class="p">))</span>
</pre>
<pre class="literal-block">
True C: 0.5, computed C: 0.350776907985
</pre>
<p>Which is the same solution found&nbsp;analytically.</p>
</div>
<div class="section" id="quality-of-common-mode-rejection-over-signal-to-noise-ratios">
<h2>Quality of common mode rejection over signal-to-noise&nbsp;ratios</h2>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">find_c</span><span class="p">(</span><span class="n">snr</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">true_C</span><span class="p">):</span>
    <span class="n">signal_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">signal_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">common_noise</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">snr</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">signal_1</span> <span class="o">+</span> <span class="n">common_noise</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">signal_2</span> <span class="o">+</span> <span class="n">common_noise</span> <span class="o">/</span> <span class="n">true_C</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</pre>
<pre class="code python literal-block">
<span class="n">true_C</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">snr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="p">[</span><span class="n">find_c</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">true_C</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">snr</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">snr</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Measured C&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;SNR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;measured C&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">true_C</span><span class="p">,</span> <span class="n">snr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">snr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;True C&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">snr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">snr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">u&quot;Naïve C&quot;</span><span class="p">,</span>
           <span class="n">color</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">snr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">snr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;C &lt; 1, (coefficient fit to larger signal)&quot;</span><span class="p">);</span>
</pre>
<img alt="Figure 3" src="/images/common_mode_rejection_files/common_mode_rejection_12_0.png" />
<pre class="code python literal-block">
<span class="n">true_C</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">snr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="p">[</span><span class="n">find_c</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">true_C</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">snr</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">snr</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Measured C&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;SNR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;measured C&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">true_C</span><span class="p">,</span> <span class="n">snr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">snr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;True C&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">snr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">snr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">u&quot;Naïve C&quot;</span><span class="p">,</span>
           <span class="n">color</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">snr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">snr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;C &gt; 1, (coefficient fit to smaller signal)&quot;</span><span class="p">);</span>
</pre>
<img alt="Figure 4" src="/images/common_mode_rejection_files/common_mode_rejection_13_0.png" />
</div>
<div class="section" id="conclusion">
<h2>Conclusion</h2>
<p>Optimizing <span class="formula"><i>C</i></span> works best when the <span class="caps">SNR</span> is low, so a segment of
recording without much signal is ideal. When fitting <span class="formula"><i>C</i></span>, choose
the noiser of the two&nbsp;channels.</p>
</div>
 
	<a class="btn btn-mini xsmall" href="/finding-common-mode-rejection-coefficient.html">
          <i class="icon-comment"></i> Comment </a>
	<hr />
      </div>
      
    </div>
    

 
        



    <div class='row-fluid'>
      <div class='article-title span9'> 
        <a href="/convert-display-shapefile-matplotlib.html"><h1>Convert and Display a Shapefile in&nbsp;Matplotlib</h1></a>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span2">
<p>Sat 06 September 2014 </p>

<p style="text-align: left;">
Filed under <a href="/category/python.html">Python</a>
</p>
<p style="text-align: left;">
 
    Tags <a href="/tag/matplotlib.html">matplotlib</a> <a href="/tag/basemap.html">basemap</a> <a href="/tag/gis.html">GIS</a> <a href="/tag/shapefile.html">shapefile</a> </p>
<p>
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="kye_brown">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
</p>
      </div>
      <div class="summary span8">
	<p class="first last">Convert a shapefile to geographic coordinates and display using matplotlib and&nbsp;basemap.</p>
 
	<a class="btn btn-mini xsmall" href="/convert-display-shapefile-matplotlib.html">
          <i class="icon-plus-sign"></i> Read More </a>
	<hr />
      </div>
      
    </div>
      

 
        



    <div class='row-fluid'>
      <div class='article-title span9'> 
        <a href="/blogging-with-github-pelican.html"><h1>Blogging with Github +&nbsp;Pelican</h1></a>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span2">
<p>Wed 20 August 2014 </p>

<p style="text-align: left;">
Filed under <a href="/category/python.html">Python</a>
</p>
<p style="text-align: left;">
 
    Tags <a href="/tag/pelican.html">pelican</a> <a href="/tag/python.html">python</a> </p>
<p>
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="kye_brown">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
</p>
      </div>
      <div class="summary span8">
	<p>In the name of fun and procrastination, I have moved my irregular internet musings to this Pelican powered github&nbsp;site.</p>
<p><a href="http://blog.getpelican.com/">Pelican</a> is a neat little static site generator, similar to Jekyll, but using Python (my preferred language). Pelican generates content from markdown, reStructuredText or html files, the latter allowing the ...</p> 
	<a class="btn btn-mini xsmall" href="/blogging-with-github-pelican.html">
          <i class="icon-plus-sign"></i> Read More </a>
	<hr />
      </div>
      
    </div>
      
<div class="pagination">
<ul>
    <li class="prev disabled"><a href="#">&larr; Previous</a></li>

    <li class="active"><a href="/index.html">1</a></li>

    <li class="next disabled"><a href="#">&rarr; Next</a></li>

</ul>
</div>
 
  
        </div>
        
        
    </div>     </div> </div>

<!--footer-->
<div class="container">
  <div class="well" style="background-color: #E9EFF6">
    <div id="blog-footer">
      <div class="row-fluid">
	<div class="social span2" align="center" id="socialist">
	  <ul class="nav nav-list">
	    <li class="nav-header">
	      Social
	    </li>
	    <li><a href="https://twitter.com/kye_brown"><i class="icon-twitter" style="color: #1f334b"></i>twitter</a></li>
	    <li><a href="https://github.com/kylerbrown"><i class="icon-github" style="color: #1f334b"></i>github</a></li>

	  </ul>
	</div>
	<div class="site-nav span2" align="center">
          <ul class="nav nav-list" id="site-links">
            <li class="nav-header"> 
              Site
            </li>
            <li><a href=""><i class="icon-home" style="color: #1f334b">
                </i>Home</a></li>
            <li><a href="/archives.html"><i class="icon-list" style="color: #1f334b">
                </i>Archives</a></li>
	    <li><a href="/tags.html"><i class="icon-tags" style="color: #1f334b">
                </i>Tags</a></li>
	    
	  </ul>

        </div>

      </div> <!--end of fluid row-->
    </div> <!--end of blog-footer-->
    <hr />
    <p align="center">
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">Fasciculus</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://kylerbrown.github.io" property="cc:attributionName" rel="cc:attributionURL">Kyler Brown</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
      Powered by <a href="github.com/getpelican/pelican">Pelican</a>,
        <a href="https://twitter.github.com/bootstrap">Twitter Bootstrap</a>, 
        <a href="http://fortawesome.github.com/Font-Awesome">Font Awesome</a>,
        <a href="http://gregoryloucas.github.com/Font-Awesome-More">Font Awesome More</a></p>

  </div> <!--end of well -->
</div> <!--end of container -->

<!--/footer-->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>


<script>var _gaq=[['_setAccount','UA-54045702-1'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>

</body>
</html>